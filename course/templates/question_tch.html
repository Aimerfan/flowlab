{% extends 'base.html' %}
{% load static %}
{% block title %}
    問卷
{% endblock %}
{% block body %}
    {% include 'components/sidebar.html' %}
    <div class="container container_close">
        <div class="content">
            <div class="row">
                <div class="col-sm-2"></div>
                <div class="col-sm-8"><h2>{{ course.name }} - {{ lab.name }}</h2><br><h1>實驗後問卷</h1></div>
                <div class="col-sm-2"></div>
            </div>
            <div class="d-flex justify-content-evenly mt-3">
                <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#wordQuestion">新增問答 (純文字回答)</button>
                {# 新增問題 (純文字) 的互動視窗 #}
                <div class="modal fade" id="wordQuestion" tabindex="-1" aria-labelledby="wordQuestionLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <form method="post">
                                {% csrf_token %}
                                <div class="modal-header">
                                    <h5 class="modal-title" id="wordQuestionLabel">新增問答題 (純文字回答)</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-floating">
                                        <textarea class="form-control" placeholder="請輸入題目...." id="question" name="content" style="height: 120px"></textarea>
                                        <label for="question">題目</label>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                                    <button type="submit" class="btn btn-primary" name="action" value="newWordQuestion">新增</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#radioQuestion">新增單選</button>
                {# 新增單選 的互動視窗 #}
                <div class="modal fade" id="radioQuestion" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="radioQuestionLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <form method="post">
                                {% csrf_token %}
                                <div class="modal-header">
                                    <h5 class="modal-title" id="radioQuestionLabel">新增單選題</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-floating">
                                        <textarea class="form-control" placeholder="請輸入題目...." id="question" name="content" style="height: 120px"></textarea>
                                        <label for="question">題目</label>
                                    </div>
                                    <div id="choiceList">
                                        <div id="choiceDiv">
                                            <div class="form-floating mt-3">
                                                <input class="form-control" id="option" name="option">
                                                <label for="option">選項 1</label>
                                            </div>
                                            <div class="mt-1">
                                                <button class="btn btn-outline-primary btn-sm">save</button>
                                                <button class="btn btn-outline-danger btn-sm">delete</button>
                                                <button class="btn btn-outline-success btn-sm" id="newChoice">new</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                                    <button type="submit" class="btn btn-primary" name="action" value="newSingleQuestion">新增</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#multiQuestion">新增多選</button>
                {# 新增多選 的互動視窗 #}
                <div class="modal fade" id="multiQuestion" tabindex="-1" aria-labelledby="multiQuestionLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <form method="post">
                                {% csrf_token %}
                                <div class="modal-header">
                                    <h5 class="modal-title" id="multiQuestionLabel">新增多選</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-floating">
                                        <textarea class="form-control" placeholder="請輸入題目...." id="question" name="content" style="height: 120px"></textarea>
                                        <label for="question">題目</label>
                                    </div>
                                    <div id="choiceList">
                                        <div id="choiceDiv">
                                            <div class="form-floating mt-3">
                                                <input class="form-control" id="option" name="option">
                                                <label for="option">選項 1</label>
                                            </div>
                                            <div class="mt-1">
                                                <button class="btn btn-outline-primary btn-sm">save</button>
                                                <button class="btn btn-outline-danger btn-sm">delete</button>
                                                <button class="btn btn-outline-success btn-sm" id="newChoice">new</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                                    <button type="submit" class="btn btn-primary" name="action" value="newMultiQuestion">新增</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container container_close">
        <div class="content">
            {% for question in questions %}
                <div class="mb-2 row">
                    <form method="post">
                        {% csrf_token %}
                        <label style="display: none;"><input name="id" value="{{ question.id }}"></label>
                            {% if question.type == 'text' %}
                                <label style="display: none;"><input name="type" value="{{ question.type }}"></label>
                                <label class="form-label col-sm-10 text-start">
                                    {{ question }}
                                    <textarea class="form-control"></textarea>
                                </label>
                            {% elif question.type == 'single' %}
                                <label style="display: none;"><input name="type" value="{{ question.type }}"></label>
                                    <label class="form-label col-sm-10 text-start">
                                    {{ question }}
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="radio" id="1" name="radio" value="A">A
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="radio" id="2" name="radio" value="B">B
                                        </label>
                                    </div>
                                </label>
                            {% elif question.type == 'multiple' %}
                                <label style="display: none;"><input name="type" value="{{ question.type }}"></label>
                                <label class="form-label col-sm-10 text-start">
                                    {{ question }}
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="checkbox" name="1" value="123456">123456
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="checkbox" name="2" value="456789">456789
                                        </label>
                                    </div>
                                </label>
                            {% endif %}
                        <div>
                            {% if question.type == 'single' or question.type == 'multiple' %}
                            <button type="submit" class="btn btn-outline-success btn-sm" name="action" value="newOption">new option</button>
                            {% endif %}
                            <button type="submit" class="btn btn-outline-primary btn-sm" name="action" value="updateQuestion">update</button>
                            <button type="submit" class="btn btn-outline-danger btn-sm" name="action" value="delQuestion">delete</button>
                        </div>
                    </form>
                </div>
            {% endfor %}
        </div>
    </div>

    {# import jQuery #}
    <script src="{% static 'js/jquery-3.6.0.min.js' %}"></script>
    <script>
    {
        let newBtn = $('#newChoice');
        {# 新增 單選或多選 的選項 #}
        newBtn.click(function () {
            $('#choiceList').append($('#choiceDiv').html());
        });
    }
    </script>
{% endblock %}